<style>
	#overflow-x-back {
		width: 100%;
		height: 25px;
		background: #999;
		position: relative;
	}

	#overflow-x-front {
		width: 140px;
		height: 25px;
		background: #5bc0de;
		position: relative;
	}

	#overflow-x-front span {
		padding-left: 45px;
		color: white;
		font-size: 16px;
	}

	#div-overflow-back {
		width: 100%;
		overflow: hidden;
		position: relative;
	}

	#div-overflow-front {
		width: 1800px;
		position: relative;
	}
</style>

<div class="row">
	<div class="col-md-12">
		<h3 class="page-header">商品信息列表</h3>
	</div>
</div>

<div class="panel panel-default">
	<div class="panel-heading">
		<div class="col-md-12">
			<form class="form-horizontal" action="${rc.contextPath}/goods/list.html?page=$!page" method="post">
				<div class="form-group">
					<div class="col-md-6">
						<label class="col-sm-3 control-label">是否停售：</label>
						<div class="col-sm-3">
							<select name="state" class="form-control">
			                <option value="">所有</option>
			                <option value="True" #if($!{queryForm.state}=='True') selected#end>True</option>
			                <option value="False" #if($!{queryForm.state}=='False') selected#end>False</option>
			            </select>
						</div>
						<label class="col-sm-3 control-label">是否带电：</label>
						<div class="col-sm-3">
							<select name="isElectric" class="form-control">
			                <option value="">所有</option>
			                <option value="True" #if($!{queryForm.isElectric}=='True') selected#end>True</option>
			                <option value="False" #if($!{queryForm.isElectric}=='False') selected#end>False</option>
			            </select>
						</div>
					</div>
					<div class="col-md-6">
						<div class="col-sm-6">
							<input id="bigCataName" type="text" class="form-control" name="bigCataName" value="$!{queryForm.bigCataName}" placeholder="大类名称">
						</div>
						<div class="col-sm-6">
							<input id="smallCataName" type="text" class="form-control" name="smallCataName" value="$!{queryForm.smallCataName}" placeholder="小类名称">
						</div>
					</div>
				</div>
				<div class="form-group">
					<div class="col-sm-8">
						<input id="parentSkus" type="text" class="form-control" name="parentSkus" value="$!{queryForm.parentSkus}" placeholder="商品编码：多个请用,隔开">
					</div>
					<div class="col-sm-2">
						<input id="bussOwner1" type="text" class="form-control" name="bussOwner1" value="$!{queryForm.bussOwner1}" placeholder="业绩归属1">
					</div>
					<div class="col-sm-2">
						<input id="bussOwner2" type="text" class="form-control" name="bussOwner2" value="$!{queryForm.bussOwner2}" placeholder="业绩归属2">
					</div>
				</div>
				<div class="form-group">
					<div class="col-sm-2">
						<input id="buyer" type="text" class="form-control" name="buyer" value="$!{queryForm.buyer}" placeholder="采购员">
					</div>
					<label class="col-sm-2 control-label">创建时间：</label>
					<div class="col-sm-5">
						<input id="dateBegin" name="createTmBegin" type="text" value="$!{queryForm.createTmBegin}"> 到 <input id="dateEnd" name="createTmEnd" type="text" value="$!{queryForm.createTmEnd}">
					</div>
					<div class="col-sm-3">
						<label class="col-sm-6 control-label">每页显示：</label>
						<div class="col-sm-6">
							<select name="pageSize" class="form-control">
			                <option value="10" #if($!pageSize=='10') selected#end>10</option>
			                <option value="20" #if($!pageSize=='20') selected#end>20</option>
			                <option value="50" #if($!pageSize=='50') selected#end>50</option>
			                <option value="100" #if($!pageSize=='100') selected#end>100</option>
			                <option value="200" #if($!pageSize=='200') selected#end>200</option>
			                <option value="500" #if($!pageSize=='500') selected#end>500</option>
			                <option value="1000" #if($!pageSize=='1000') selected#end>1000</option>
			            	</select>
						</div>
					</div>
				</div>
				<div class="form-group">
					<div class="col-sm-12">
						<button type="button" class="btn btn-success" data-toggle='modal' data-target='#importModal'>普源导入</button>
						<button type="button" class="btn btn-success" data-toggle='modal' data-target='#wishImportModal'>Wish导入</button>
						<!--
						<button type="button" class="btn btn-success" data-toggle='modal' data-target='#joomImportModal'>Joom导入</button>
						<button type="button" class="btn btn-info margin-bottom" onclick="window.open('${rc.contextPath}/excel/export/common.html')">普源导出</button>
						<button type="button" class="btn btn-info margin-bottom" onclick="window.open('${rc.contextPath}/csv/export/wish.html')">Wish导出</button>
						<button type="button" class="btn btn-info margin-bottom" onclick="window.open('${rc.contextPath}/csv/export/joom.html')">Joom导出</button>
						-->
						<button type="submit" class="btn btn-info">查询</button>
						<button type="button" class="btn btn-info" data-toggle='modal' data-target='#exportModal'>导出刊登</button>
					</div>
				</div>
			</form>
		</div>
		<div class="clearfix"></div>
	</div>

	<div id="div-overflow-back" class="panel-body">
		<div id="overflow-x-back">
			<div id="overflow-x-front"><span>滚动条</span></div>
		</div>
		<div id="div-overflow-front">
			<table class="table table-striped table-bordered table-hover">
				<thead>
					<tr>
						<th width="115px">操作</th>
						<th width="60px">Listing<br>主图</th>
						<th width="60px">SKU<br>主图</th>
						<th width="60px">SKU</th>
						<th width="60px">商品<br>编码</th>
						<th width="100px">商品<br>名称</th>
						<th width="60px">大类<br>名称</th>
						<th width="60px">小类<br>名称</th>
						<th width="50px">是否<br>停售</th>
						<th width="50px">是否<br>带电</th>
						<th width="60px">重量<br>（G）</th>
						<th width="60px">成本<br>（元）</th>
						<th width="60px">业绩<br>归属1</th>
						<th width="80px">业绩<br>归属2</th>
						<th width="60px">采购员</th>
						<th width="50px">所有<br>库存</th>
						<th width="150px">供应商</th>
						<th >标题</th>
						<th width="90px">创建时间</th>
						<th width="90px">更新时间</th>
					</tr>
				</thead>
				<tbody>
					#if(!$!{pageModel.recList} || $!{pageModel.recList.size()} == 0)
					<tr>
						<td colspan="11">
							<h3>无数据</h3>
						</td>
					</tr>
					#end #foreach($rec in $!{pageModel.recList})
					<tr>
						<td>
							<button type="button" class="btn btn-warning btn-sm margin-bottom" onclick="window.location.href='${rc.contextPath}/goods/edit.html?sku=$!{rec.goods.sku}'">修改</button>
							<button type="button" class="btn btn-danger btn-sm margin-bottom" onclick="window.location.href='${rc.contextPath}/goods/delete.html?sku=$!{rec.goods.sku}'">删除</button>
						</td>
						<td><img class="lazy" height="40px" width="40px" data-original="http://www.bentain.site/$!{rec.goods.sku}-mainImgUrl.jpg"
							/></td>
						<td><img class="lazy" height="40px" width="40px" data-original="http://www.bentain.site/$!{rec.goods.sku}-vMainImgUrl.jpg"
							/></td>
						<td>$!{rec.goods.sku}</td>
						<td>$!{rec.goods.parentSku}</td>
						<td>$!{rec.goods.name}</td>
						<td>$!{rec.goods.bigCataName}</td>
						<td>$!{rec.goods.smallCataName}</td>
						<td>$!{rec.goods.state}</td>
						<td>$!{rec.goods.isElectric}</td>
						<td>$!{rec.goods.weight}</td>
						<td>$!{rec.goods.costPrice}</td>
						<td>$!{rec.goods.bussOwner1}</td>
						<td>$!{rec.goods.bussOwner2}</td>
						<td>$!{rec.goods.buyer}</td>
						<td>$!{rec.goods.allNum}</td>
						<td>
							#if("$!{rec.goods.url}" != "") <a target="_blank" class="btn btn-info btn-sm margin-bottom" href="$!{rec.goods.url}">供1</a>#end
							#if("$!{rec.goods.url2}" != "") <a target="_blank" class="btn btn-info btn-sm margin-bottom" href="$!{rec.goods.url2}">供2</a>#end
							#if("$!{rec.goods.url3}" != "") <a target="_blank" class="btn btn-info btn-sm margin-bottom" href="$!{rec.goods.url3}">供3</a>#end
						</td>
						<td>$!{rec.goodsPlat.title}</td>
						<td>$!{rec.goods.createTm}</td>
						<td>#if($!{rec.goods.modifyTm}) $!{rec.goods.modifyTm} #else $!{rec.goodsPlat.modifyTm} #end</td>
					</tr>
					#end
				</tbody>
			</table>
		</div>
		#parse("/base/page.vm")
	</div>
</div>

<!-- import Modal-->
<div id="importModal" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">导入普源数据</h4>
			</div>
			<div class="modal-body">
				<form id="importForm" action="${rc.contextPath}/excel/import/common.html" enctype="multipart/form-data" method="post">
					<div class="form-group">
						<label>请选择待导入的文件</label>
						<input type="file" name="file">
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="confirm-yes btn btn-primary" id="btnImport">提交</button>
				<button type="button" class="confirm-no btn btn-danger" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>
</div>

<!-- wish import Modal-->
<div id="wishImportModal" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">导入Wish数据</h4>
			</div>
			<div class="modal-body">
				<form id="wishImportForm" action="${rc.contextPath}/csv/import/wish.html" enctype="multipart/form-data" method="post">
					<div class="form-group">
						<label>请选择待导入的文件</label>
						<input type="file" name="file">
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="confirm-yes btn btn-primary" id="btnWishImport">提交</button>
				<button type="button" class="confirm-no btn btn-danger" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>
</div>

<!-- joom import Modal-->
<div id="joomImportModal" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">导入Joom数据</h4>
			</div>
			<div class="modal-body">
				<form id="joomImportForm" action="${rc.contextPath}/csv/import/joom.html" enctype="multipart/form-data" method="post">
					<div class="form-group">
						<label>请选择待导入的文件</label>
						<input type="file" name="file">
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="confirm-yes btn btn-primary" id="btnJoomImport">提交</button>
				<button type="button" class="confirm-no btn btn-danger" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>
</div>

<!-- exportModal Modal-->
<div id="exportModal" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">导出刊登</h4>
			</div>
			<div class="modal-body">
				<form id="exportForm" action="${rc.contextPath}/export.html" method="post">
					<input type="hidden" id="skuQuery-export" name="skuQuery">
					<input type="hidden" id="nameQuery-export" name="nameQuery">
					<div class="form-group">
						<label>选择平台</label>
						<select name="platformId" class="form-control">
					#foreach($!platform in $!platforms)
                    	<option value="$!{platform.id}">$!{platform.name}</option>
					#end
                </select>
					</div>
					<div class="form-group">
						<label>选择物流产品</label>
						<select name="prodId" class="form-control">
					#foreach($!prod in $!prods)
                    <option value="$!{prod.id}">$!{prod.name}</option>
					#end
                </select>
					</div>
					<div class="form-group">
						<label>选择图片域名</label>
						<select name="domainName" class="form-control">
					#foreach($!domain in $!domains)
                    <option value="$!{domain.name}">$!{domain.name}</option>
                	#end
                </select>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="confirm-yes btn btn-primary" id="btnExport">提交</button>
				<button type="button" class="confirm-no btn btn-danger" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>
</div>

<script>
	$(function () {
		$("img.lazy").lazyload();
		$.datetimepicker.setLocale('zh');
		$("#dateBegin").datetimepicker({
          format:'Y-m-d',
          onShow:function( ct ){
           this.setOptions({
            maxDate:$("#dateEnd").val()?$("#dateEnd").val():false
           })
          },
          timepicker:false
         });
         $("#dateEnd").datetimepicker({
          format:'Y-m-d',
          onShow:function( ct ){
           this.setOptions({
            minDate:$("#dateBegin").val()?$("#dateBegin").val():false
           })
          },
          timepicker:false
         });
	});

	window.onload = function () {
		var oDiv1 = document.getElementById('overflow-x-back');
		var oDiv2 = document.getElementById('overflow-x-front');
		var oDiv3 = document.getElementById('div-overflow-back');
		var oDiv4 = document.getElementById('div-overflow-front');
		var iMaxWidth = oDiv1.offsetWidth - oDiv2.offsetWidth;
		oDiv2.onmousedown = function (ev) {
			var ev = ev || event;
			var disX = ev.clientX - this.offsetLeft;
			document.onmousemove = function (ev) {
				var ev = ev || event;
				var T = ev.clientX - disX;
				if (T < 0) {
					T = 0;
				} else if (T > iMaxWidth) {
					T = iMaxHeight;
				}
				var iScale = T / iMaxWidth;
				oDiv4.style.left = (oDiv3.offsetWidth - 30 - oDiv4.offsetWidth) * iScale + 'px';
				oDiv2.style.left = T + 'px';
			}
			document.onmouseup = function () {
				document.onmousemove = document.onmouseup = null;
			}
			return false;
		}
	}

	$("#btnImport").on("click", function () {
		$("#importForm").submit();
	})

	$("#btnWishImport").on("click", function () {
		$("#wishImportForm").submit();
	})

	$("#btnJoomImport").on("click", function () {
		$("#joomImportForm").submit();
	})

	$("#btnExport").on("click", function () {
		$("#exportForm").submit();
	})

	$("#exportModal").on("show.bs.modal", function (event) {
		var skuQuery = $("#skuQuery").val();
		var nameQuery = $("#nameQuery").val();
		var modal = $(this);
		modal.find("#skuQuery-export").val(skuQuery);
		modal.find("#nameQuery-export").val(nameQuery);
	})

</script>